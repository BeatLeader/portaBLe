@page
@model portaBLe.Pages.WeightedScoresGraphModel
@{
    ViewData["Title"] = "Weighted Scores Graph";
}

<h2>Weighted Scores Graph</h2>

<label for="ySelect">Select Y-axis:</label>
<select id="ySelect">
    <option value="pp">Weighted PP</option>
    <option value="acc">Score Accuracy</option>
    <option value="accPP">Weighted Acc PP</option>
    <option value="passPP">Weighted Pass PP</option>
    <option value="techPP">Weighted Tech PP</option>
</select>

<div id="myPlot" style="width:100%;height:500px;"></div>

@section Scripts {
    <script src="https://cdn.plot.ly/plotly-2.29.1.min.js"></script>
    <script>
        const data = @Html.Raw(Model.WeightedJsonData);

        function renderPlot(yField) {
            const tracePoints = {
                x: data.map(p => p.x),
                y: data.map(p => p[yField]),
                mode: 'markers',
                type: 'scattergl',
                marker: { size: 4, color: 'blue', opacity: 0.2 },
                name: 'Points'
            };

            const layout = {
                title: 'Weighted Scores Scatter Plot',
                xaxis: { title: 'Stars' },
                yaxis: { title: 'PP' },
                hovermode: 'closest',
                margin: { t: 50, b: 50, l: 50, r: 50 }
            };
            Plotly.react('myPlot', [tracePoints], layout);
        }

        renderPlot('pp');

        document.getElementById('ySelect').addEventListener('change', function () {
            renderPlot(this.value);
        });
    </script>
    }
}